# Borwser가 웹 페이지를 표현하는 방법

### 정확한 용어
 - 영어 원문, 발음 
 - 업계에서 원활한 의사소통
 - 동료간 상호 신뢰  
 - 번역의 문제
   - 영어는 의미 명확하지만 한글로 번역시 모호해지는 용어가 존재
       - 예) Unobtrusive javascript
         - 웹 페이지가 자바스크립트에 대해 가지는 의존도를 줄이고, 사용성을 높이기 위해 자바스크립트를 적소에만 사용하는 것
         - Unobrusive를 '겸손한', '나대지 않는' 등의 한국어 단어로 제안됨.
   - 정착된 번역어가 아닌 경우 존재
 - 자료 검색 측면에서 이점
   - 자료의 양 및 질적인 측면에서 접근성 향상
   - 스택오버플로우 등 
 - 해외 취업 또는 해외 개발자와 협업시 이점
 - 오픈 소스 기여 이점

### 명확한 근거
 - 모든 결정에는 구체적인 이유를 주장
   - 예)
     - 코드의 한 라인에도 이유가 필요
     - 기술의 도입 근거 필요
       - 장, 단점 파악


### 웹 브라우저
 - 플랫폼 동작 원리 이해 필요 
   - 좋은 코드 작성 가능 및 성능과 연관
 - 웹 페이지 로드 과정
   - 참고
     - W3C Navigation timing level 2 spec
   
### 브라우저 주요 구성 요소
  - 내부 구조 동작
    ```
        (탑다운)
        [사용자 인터페이스]

        [브라우저 엔진]                ->      [데이터 저장소]

        [렌더링 엔진]

        [통신]  [JS 해석기]   [UI 백엔드]
    ```
   - flow
      - case1. 사용자 인터페이스 -> 브라우저 엔진 -> 랜더링 엔진 -> (통신, JS 해석기, UI 백엔드)
      - case2. 사용자 인터페이스 -> UI 백엔드
      - case3. 브라우저 엔진 -> 데이터 저장소
  - 브라우저 chrome application 기준 외부 구조
    - 사용자 인터페이스
    - 렌더링 엔진
      - 실질적으로 페이지를 표현
      - 참고
        - NAVER D2 : 브라우저는 어떻게 동작하는가(2011)
         - 대체로 유효
        - 모던 웹 브라우저 들여다보기 (2018) *****

### 렌더링 엔진의 동작 과정
  - HTML, CSS, JS 파싱
    - 문서를 읽어 브라우저가 문법을 분석, 코드를 이해
    - `<script>` 태그를 만나면 JS를 해석할 때 까지 파싱을 멈춤
      - 파싱을 멈추는 이유
        - JS는 도큐먼트 write를 통해 문서 구성에 영향을 줌
      - 가능한 끝에 배치가 좋으나 모던 웹 개발에서는 필요성이 사라짐
      - 성능과 연관
  - DOM, CSSOM 변환
    - 브라우저에서 사용할 수 있는 구조로 변환한다.
    - 문법 해석 이후 메모리에 브라우저에서 사용할 수 있는 객체로 변환 (결과가 DOM)
    - 자바스크립트에 css 속성 접근 가능한 이유는 css도 CSSOM로 변환함
  - 렌더 트리 구축
    - DOM과 CSSOM을 결합하여 화면에 그려낼 내용을 작성
    - 즉, 어떤 엘리먼트에 어떤 스타일을 적용할 것인지 결정
  - 렌더 트리 배치
    - 각 요소의 크기와 위치를 계산한다. (layout 단계) 
    - layout이 30개 넘는 경우 브라우저 성능 저하 이슈 가능성 존재
  - 렌더 트리 그리기 
    - viewport(실제 보이는 화면)
    - 요소를 실제로 픽셀로 변환하여 그린다. (Paint 단계, Rasterize)
    - 픽셀로 그려진 여러 레이어를 합성한다. (Compositing 단계)
    - 크롬 개발자 도구를 통해 레이어 살펴보기
      - More -> Layers
  - 점진적으로 실행 
    - 한 페이지 내 모든 요소를 한 번에 다 처리하지 않고 iterater 처리
      - 더 나은 사용자 경험을 위해서
  - 자바스크립트 랜더링 과정은 싱글 스레드
    - 즉 랜더링의 앞 단계 간 경우 뒷 단계가 멈춤
    - 예)
      - 새로운 css파일을 읽는 과정에서 랜더링을 멈출 수 있다.
        - 예) import(웹 브라우저가 css를 읽을 때 web import 시 네트워크 요청 후 데이터 해석 후 다시 랜더링함) 를 쓰지 않는 이유
          - 단, 모던 웹은 import를 모듈 번들링(웹팩, 롤업 등)을 통해 합치므로 예외적인 상황이 가능하다 (단 네트워크 import가 아닌 경우)
          - 모듈 번들링은 찔끔찔금 로딩해서 랜더링 방해말고 한번에 로딩 후 랜더링 처리하자

### 재랜더링 시
  - 이벤트에 따라 특정 단계부터 시작
  - 랜더링 성능 향상을 위해 특정 단계 skip

### 궁금증
  - 렌더 트리 배치 시 layout을 어떤 규칙으로 어떻게 작성될까? 개발자가 직접 만드는 게 가능할까?
  - 웹팩의 장단점은?
  - 랜더 트리 리랜더링 시 단계를 skip하여서 최적화 하는 기법에 대한 조사