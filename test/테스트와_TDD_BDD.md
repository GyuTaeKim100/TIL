# 테스트와 TDD, BDD

## 코드 커버리지

- 보통 라인 수
- 어떤 라인이 실제로 수행했는지
- 70% 이상이 훌륭, 100%는 불가
  - 사용자의 입력 등으로 해결이 필요한 코드 라인이 존재
    - E2E로 일부 커버 가능
- 코드로 구현 불가능한 테스트도 존재

## TDD

- 테스트 주도 개발
- 장점
  - 테스트를 먼저 작성
  - 테스트 커버리지 비율 자연스럽게 높아진다
  - 테스트 되는 코드만 작성, 코드 방대 방지
  - 코드가 원하는 명확한 바 달성 쉽다
- 진행
   1. 테스트 실행
   2. 테스트를 통과하는 코드를 작성
   3. 리팩토링
  - 중복 및 개선사항 반영
- TDD 3대 원칙
  - 실패할 테스트를 작성하기 전에 프로덕트 코드를 작성말자
  - 실패할 테스트 말고는 작성말자
  - 현재 실패할 테스트를 만족할 코드만을 작성하자
- ODA 원칙
  - O: 옵저베이션
  - D: 디시젼
  - A: 액션
  - 결정하고 실행하기 전에 먼저 관찰부터 하자
  - 주기
    - 1주기
      - <실행> 문제를 관찰하고 해결할지 말지 결정하고 테스트를 작성하자
    - 2주기
      - <실행> 테스트를 보고 API를 괜찮은지 관찰하고 안괜찮으면 수정방법을 결정하고 테스트를 수정 (통과까지 반복)
    - 3주기
      - <관찰> API가 괜찬으면 테스트를 실행하고 통과하는 여부를 확인한다 (당연히 실패)
      - <결정> 테스트를 어떻게 통과할 지 방법을 정한다. 코드 구현에 대한 설계
      - <실행> 테스트를 통과할 코드를 작성
    - 4주기
      - <관찰> 테스트를 실행해서 작성한 코드가 테스트를 통과하는 지 관찰
      - <실행과 결정, 실행을 계속 반복> 통과 못하면 코드를 어떻게 수정할 지 결정 후 코드 작성
- 예제) 3, 6, 9 게임

- 369.spec.js 1차

    ```
      import {game} from './369';

      describe('369게임', () => {
          it('[1, 2]를 넣으면 일, 이가 반환되어야 한다', () => {
              expect(game([1, 2])).toBe('일, 이');
          })
      })
    ```
  - 테스트 실패
- 369.js 1차

    ```
        export function game(arr){
            const hangul = '영일이삼사오육칠팔구';
            const read =arr.map((num)=> {
                return hangul[num];
            })

            return read.join(',')
        }
    ```
  - 테스트 통과
- 369.spec.js 2차

      ```
        import {game} from './369';

        describe('369게임', () => {
            it('[1, 2]를 넣으면 일, 이가 반환되어야 한다', () => {
              expect(game([1, 2])).toBe('일, 이');
            })

            it('[1,2,3]은 일,이,짝으로 읽어야 한다', () => {
              expect(game([1,2,3])).toBe('일,이,짝');
            })
        })
      ```
  - 테스트 실패
- 369.js 2차

      ```
          export function game(arr){
              const hangul = '영일이삼사오육칠팔구';
              const read =arr.map((num)=> {
                  if (num == 3) {
                      return '짝';
                  }
                  return hangul[num];
              })

              return read.join(',')
          }
      ```
  - 테스트 통과
- 369.spec.js 3차

      ```
        import {game} from './369';

        describe('369게임', () => {
            it('[1, 2]를 넣으면 일, 이가 반환되어야 한다', () => {
              expect(game([1, 2])).toBe('일, 이');
            })

            it('[1,2,3]은 일,이,짝으로 읽어야 한다', () => {
              expect(game([1,2,3])).toBe('일,이,짝');
            })

            it('[1,2,3,4,5,6]은 일, 이 , 짝, 사, 오 , 짝으로 읽어야 한다', () => {
                expect(game([1,2,3,4,5,6])).toBe('일,이,짝,사,오,짝')
            })
        })
      ```

- 369.js 3차

      ```
          export function game(arr){
              const hangul = '영일이삼사오육칠팔구';
              const read =arr.map((num)=> {
                  if (num == 3) {
                      return '짝';
                  }
                  
                  if (num === 6) {
                      return '짝'
                  }

                  return hangul[num];
              })

              return read.join(',')
          }
      ```
  - 테스트 통과
- 369.spec.js 4차

      ```
        import {game} from './369';

        describe('369게임', () => {
            it('[1, 2]를 넣으면 일, 이가 반환되어야 한다', () => {
              expect(game([1, 2])).toBe('일, 이');
            })

            it('[1,2,3]은 일,이,짝으로 읽어야 한다', () => {
              expect(game([1,2,3])).toBe('일,이,짝');
            })

            it('[1,2,3,4,5,6]은 일,이,짝,사,오,짝으로 읽어야 한다', () => {
                expect(game([1,2,3,4,5,6])).toBe('일,이,짝,사,오,짝')
            })

            it('[1,2,3,4,5,6,7,8,9]은 일,이,짝,사,오,짝,칠,팔,짝으로 읽어야 한다', () => {
                expect(game([1,2,3,4,5,6,7,8,9])).toBe('일,이,짝,사,오,짝,칠,팔,짝')
            })
        })
      ```
  - 테스트 실패
- 369.js 3차

      ```
          export function game(arr){
              const hangul = '영일이삼사오육칠팔구';
              const read =arr.map((num)=> {
                  if (num === 3)| num === 6 | num === 9) {
                      return '짝';
                  }
                

                  return hangul[num];
              })

              return read.join(',')
          }
      ```
  - 테스트 통과
- 369.spec.js 5차

      ```
        import {game} from './369';

        describe('369게임', () => {
            it('[1, 2]를 넣으면 일, 이가 반환되어야 한다', () => {
              expect(game([1, 2])).toBe('일, 이');
            })

            it('[1,2,3]은 일,이,짝으로 읽어야 한다', () => {
              expect(game([1,2,3])).toBe('일,이,짝');
            })

            it('[1,2,3,4,5,6]은 일,이,짝,사,오,짝으로 읽어야 한다', () => {
                expect(game([1,2,3,4,5,6])).toBe('일,이,짝,사,오,짝')
            })

            it('[1,2,3,4,5,6,7,8,9]은 일,이,짝,사,오,짝,칠,팔,짝으로 읽어야 한다', () => {
                expect(game([1,2,3,4,5,6,7,8,9])).toBe('일,이,짝,사,오,짝,칠,팔,짝')
            })

            it('[10,11,12,13]은 십,십일,십이,짝으로 읽어야 한다', () => {
                expect(game([10,11,12,13])).toBe('십,십일,십이,짝');
            })

            it('[29,30,31,32,33]은 이십구,짝,짝,짝,짝짝', () => {
                expect(game([10,11,12,13])).toBe('이십구,짝,짝,짝,짝짝');
            }) 
        })
      ```
  - 이후는 깃헙 링크를 참고...

## BDD

- 행위 주도 개발
- 사용자 시나리오에 집중
- TDD와 비슷
