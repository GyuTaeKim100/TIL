# 테스팅 원칙

## 기본 원칙

1. 한번 작성된 테스트 코드는 영원히 유지보수 해야 한다.
2. 내부 구현 사항을 테스트하면 안된다.
    - API 단위로 테스트해야 한다.
    - API 단위보다 작은 단위로 테스트 시, 내부 구현이 변경(예시, 변수명 변경) 시 테스트 코드 관리가 어려워진다.
3. 재사용성을 높이기 (테스트 유틸리티)
    - 테스트용 클래스 등
4. 배포용 코드와 철저히 분리
5. 테스트코드를 통한 문서화

## 좋은 테스트 구조

- 준비(Arrange 또는 Given)
  - 테스트 수행 전 호출되는 beforeEach, beforeAll과 테스트 수행 후 호출되는 after Each, afterAll가 있다.
  - 반복된다면, 별도의 유틸리티 함수로 분리한다.
- 실행(Act 또는 When)
  - 우선 의도적으로 실패하기
    - 버그가 있음을 먼저 인지 후, 테스트 코드를 통해 성공해야 한다.
- 검증(Assert 또는 then)
  - 가장 마지막에 위치한다.
  - 방대한 경우, 여러 테스트 코드로 분리를 고려한다.

## 좋은 테스트 원칙

- F
  - Fast
  - 느린 것에 대한 의존성 낮추기
  - Mock 또는 STub 활용
  - 예시, 파일, 데이터베이스, 네트워크가 있다.

- I
  - Isolated
  - 최소한의 유닛으로 검증하기
    - 독립적이고, 집중적으로 유지
    - 테스트 실패 시, 실패 원인의 범위를 최대한 좁힐 수 있게

- R
  - Repeatable
  - 실핼할 때마다 동일한 결과를 유지
  - 환경에 영향을 받지 않도록 작성

- S
  - Self-Validating
  - (Jest 등의) 테스팅 프레임워크를 사용해서 스스로 결과를 구체적이고 통계적으로 검증함
  - 자동화를 통한 검증단계 (CI/CD)

- T
  - Timely
  - 시기적절하게 테스트 코드 작성
  - 사용자에게 배포되기 전에 테스트 코드 작성

## 테스트의 범위

- Right-BICEP

- Right
  - 모든 요구 사항이 정상 동작 하는지 확인
  - 모든 결과가 정확한지 확인

- B
  - Boundary conditions
  - 모든 코너 케이스에 대해 테스트를 하기
    - 예시, 잘못된 포맷의 인풋, null, 특수문자, 잘못된 이메일, 작은 숫자, 큰 숫자, 중복 순서가 맞지 않음.

- I
  - Inverse relationship
  - 역관계를 적용해서 결과값을 확인
  - 일관성을 유지
    - 예시
      - 덧셈 -> 뺄셈
      - 추가 -> 제거

- C
  - Cross-check
  - 다른 수단을 이용해서 결과값이 맞는지 확인 (A 알고리즘 === B 알고리즘)
    - 예시, 추가 된 과일 갯수 = 전체 과일 갯수  - 예전 과일 갯수

- E
  - Error conditions
  - 불행한 경로에 대해 우아하게 처리하는가?
    - 예시, 네트워크 에러, 메모리 부족, 데이터베이스 중지

- P
  - Performance characteristics
  - 성능 확인은 테스트를 통해 정확한 수치로 확인
  - 성능 개선의 척도와 확인 또한 데이터를 통해 확인

## 테스트의 조건

- CORRECT
- C
  - Conformance
  - 특정 포맷을 준수
    - 예시, 전화번호, 이메일, 아이디, 파일 확장자 ....  

- O
  - Ordering
  - 순서 조건 확인
    - 특히 순서가 중요한 경우

- R
  - Range
  - 범위
  - 예시, 숫자의 범위(제한된 범위보다 작거나 큰 경우)

- R
  - Reference
  - 외부 의존성 유무, 특정한 조건의 유무
  - ~일 때, ~가 되었을 때, 어떤 특정한 상황/상태 일때 이런 동작을 한다.

- E
  - Existence
  - 값이 존재하지 않을 때 어떻게 동작?
  - 예시, null, undefined, '', 0

- C
  - Cardinality
  - 0-1-N 법칙에 따라 검증
  - 예시, 하나도 없을 때, 하나만 있을 때, 여러개가 있을 때

- T
  - Time
  - 상대, 절대, 동시의 일들
  - 예시, 순서, 순서가 맞지 않은 경우, 소비한 시간, 지역 시간

## 참고

- <https://academy.dream-coding.com/courses/player/js-tdd/lessons/1144>
