# 실시간 반응형 계층 게시판 기획 초초안

## 1. 목적 및 의도

### 1. PoC (Prove of concept) 중심

  - 기획 측면의비즈니스 모델과 사용성 측면에서 UI/UX는 완전 배제

### 2. 핵심 포인트: 모던 프로그래밍 패러다임 도입
  - 함수형 패러다임 및 반응형 패러다임 및 Rx(ReactiveExtention) 숙달

  - 동기적 프로그래밍은 함수형 라이브러리인 ramda.js 활용 

  - 비동기적 프로그래밍은 Rx.js 활용
    - '순차적으로 Multiple 이벤트를 시간의 축으로 추상화한 스트림'으로 관리

### 3. Statefull 서버와 클라이언트 계층 내 (실시간) 반응형 아키텍처 설계 및 구현
- 아직까지는, 해당 사이드 프로젝트에서 반응형 아키텍처에 대한 정확한 어휘가 정의되진 않음.
- 현재 추구하는 반응형 아키텍처의 대략적인 정의는, 기존의 REST API 형식으로 서버와 클라이언트 간 비연결성 요청과 응답이 아닌, 
- Flux Architecture를 인용하여 정의해보자면 
    1. 옵저버 패턴처럼, 서버의 상태가 클라이언트에게 관찰 대상이다.
    2. 클라이언트는 서버의 상태를 구독한다.
    3. 만약 서버의 상태가 변경 시, 관찰 중인 클라이언트에게 상태 전파를 한다.
    4. 클라이언트는 전파된 상태를 통해 비즈니스 로직 또는 UI 로직을 수행한다.
    2. (사용자 선택) 만약 클라이언트에서 서버 요청이 필요한 이벤트가 발생 시, 서버에게 이벤트를 전달한다.
> flux architecture 공식 설명 : https://haruair.github.io/flux/docs/overview.html

## 2. 주요 기능 또는 도전 과제

1. 최대 동시 접속자 수 제한

   - 최대 수용 인원 초과 이후 부터 대기열 작동으로, 클라이언트는 대기해야 함.

2. 실시간으로 서버에서 클라이언트 제어

   - 서버에서 클라이언트의 접속 및 권한 및 동작을 실시간으로 제어 할 수 있다. 
      - 예시
        - 접속 관련 권한
            - '채팅 금지', 'Read Only', '부분별 권한 설정'
        - 특정 동작 조작 
            - '특정 페이지로 이동', '대기열로 보내기 등', '대기열에서 작업 페이지로 이동'

3. 클라이언트 측

    - 게시물 관련
      - 게시물 조회
      - 게시물 등록
      - 게시물 수정
      - 게시물 삭제
      - 게시물에 하위 게시물 등록
      - 게시물 단위로 실시간 갱신 On/Off
    - 서버와 세션 관리
      - 서버가 꺼져 있으면, 서버가 켜질 때까지 대기
      - 대기열 관련

4. 서버 측

    - 클라이언트에게 상태 전파 방법
      - Broadcast or Multicast or Unicast
    - 게시물 관련 (생략)
    - 클라이언트 세션 관리
      - 최대 접속자수 설정

      - 대기열 관리
      - 1개 이상의 클라이언트에 대해서 실시간으로
          - 세션 상태 변경
          - 권한 제어
          - 동작 제어
      - 클라이언트의 행동 감지 (로깅?)
      - 1분 단위로 JWT 토큰 갱신
          - Future : Oauth 

4. (비필수) 테스트 
    - 클라이언트 단
      - 유닛 테스트
      - E2E 테스트
    - 서버 단
      - 유닛 테스트
      - API 단 E2E 테스트
      - 부하 테스트

## 3. 기술 스택

### 서버

- typescript
- nestjs
- RESPTAPI + websocket
- rxjs
- typeorm or prisma
- postgresql
- redis

### 클라이언트

- typescript
- react
- webpack
- redux
- redux observable
- rxjs
- react table
- emotion

## 4. 마일스톤

1. (집) 로컬에서 서버 구축 및 운영

- DNS 설정
- https 설정

2. 기존에 작성한 `ramdajs 기반 Tree 자료구조 조작 라이브러리`를 기능 추가 및 리팩토링 및 테스트 코드 작성
  - Tree 자료구조 통해서, 계층형 게시판의 자료 구조를 조작한다.
    - 새 트리 노드 추가
    - 전체 트리 노드 순회하며
      - 특정 트리 노드 필터링
    - 전체 트리 노드 순회하며
      - 방문한 모든 트리 노드 변경(like map)
      - 특정 조건을 만족하는 트리 노드만 변경(like map)
    - 전체 트리 노드 순회하며
      - 특정 트리 노드의 props 추가 및 제거
    - flatten
    - deep flatten 
    - 특정 조건의 트리 노드 목록을 추출
    > https://github.com/gyutae100/TIL/blob/master/ramda-js/side-projects/tree-ds-utils/index.ts

3. 클라이언트에서 목업 데이터로 UI 초안 구현해보기
  - react table, 2에서 만든 라이브러리 활용

## 5. 의문 및 추가적인 자료 조사
1. 서버 - 클라이언트 계층에서 반응형 아키텍처란? 해당 사이드 프로젝트에서 어떻게 정의 내릴 것인가?

## 6. 래퍼런스
